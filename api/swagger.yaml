openapi: "3.0.0"
info:
  version: 0.0.1
  title: Campus Vault API
  description: Backend API for Campus Vault Frontend
servers:
  - url: http://localhost:8080
    description: Local Server
components:
  schemas:
    UUID:
      type: string
      format: uuid
      example: "123e4567-e89b-12d3-a456-426614174000"

    User:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        email:
          type: string
          format: email
        role:
          $ref: "#/components/schemas/UserRole"
      required:
        - id
        - email
        - role

    GroupUser:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        email:
          type: string
          format: email
        role_name:
          type: string
        scope:
          type: string
        scope_id:
          $ref: "#/components/schemas/UUID"
      required:
        - id
        - email
        - role_name
        - scope

    PaginationMeta:
      type: object
      required: [total, limit, offset, has_more]
      properties:
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
        has_more:
          type: boolean

    PaginatedItemResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/ItemResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    PaginatedBorrowingResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/BorrowingResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    PaginatedRequestResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/RequestItemResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    PaginatedBookingResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/BookingResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    PaginatedTakingHistoryResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/TakingHistoryResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    PaginatedItemTakingHistoryResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/ItemTakingHistoryResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    ItemResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
        description:
          type: string
        type:
          $ref: "#/components/schemas/ItemType"
        stock:
          type: integer
        urls:
          type: array
          items:
            type: string
            format: uri
      required:
        - id
        - name
        - type
        - stock

    ItemPostRequest:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
          example: "Laptop"
        description:
          type: string
          example: "Dell XPS 13"
        type:
          $ref: "#/components/schemas/ItemType"
        stock:
          type: integer
          example: 5
        urls:
          type: array
          items:
            type: string
            format: uri
      required:
        - id
        - name
        - type
        - stock

    InviteUserRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: "president@usstm.ca"
        role_name:
          type: string
          example: "group_admin"
        scope:
          type: string
          enum: [global, group]
          example: "group"
        scope_id:
          $ref: "#/components/schemas/UUID"
      required:
        - email
        - role_name
        - scope

    InviteUserResponse:
      type: object
      properties:
        code:
          type: string

    UserRole:
      type: string
      enum:
        - admin
        - approver
        - group_admin
        - member

    ItemType:
      type: string
      enum:
        - low
        - medium
        - high

    Error:
      type: object
      properties:
        error:
          type: object
          required:
            - code
            - message
          properties:
            code:
              type: string
              enum:
                - VALIDATION_ERROR
                - AUTHENTICATION_REQUIRED
                - PERMISSION_DENIED
                - RESOURCE_NOT_FOUND
                - INSUFFICIENT_STOCK
                - CONFLICT
                - INTERNAL_ERROR
              description: Machine-readable error code
            message:
              type: string
              description: Human-readable error message
            details:
              type: array
              description: Field-level validation errors
              items:
                type: object
                required:
                  - field
                  - message
                properties:
                  field:
                    type: string
                    description: Field name that failed validation
                  message:
                    type: string
                    description: Validation error message
            context:
              type: object
              description: Additional error context (e.g., available stock)
              additionalProperties: true
      required:
        - error

    RequestOTPRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: "user@torontomu.ca"
      required:
        - email

    VerifyOTPRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: "user@torontomu.ca"
        code:
          type: string
          minLength: 6
          maxLength: 6
          pattern: '^\d{6}$'
          example: "123456"
      required:
        - email
        - code

    TokenResponse:
      type: object
      properties:
        access_token:
          type: string
        refresh_token:
          type: string
      required:
        - access_token
        - refresh_token

    RefreshRequest:
      type: object
      properties:
        refresh_token:
          type: string
      required:
        - refresh_token

    LogoutRequest:
      type: object
      properties:
        refresh_token:
          type: string
      required:
        - refresh_token

    MessageResponse:
      type: object
      properties:
        message:
          type: string
      required:
        - message

    PingResponse:
      type: object
      properties:
        message:
          type: string
          example: "pong"
        timestamp:
          type: string
          format: date-time
          example: "2023-01-01T00:00:00Z"
      required:
        - message
        - timestamp

    AddToCartRequest:
      type: object
      properties:
        groupId:
          $ref: "#/components/schemas/UUID"
        itemId:
          $ref: "#/components/schemas/UUID"
        quantity:
          type: integer
          minimum: 1
      required:
        - groupId
        - itemId
        - quantity

    CartItemResponse:
      type: object
      properties:
        groupId:
          $ref: "#/components/schemas/UUID"
        userId:
          $ref: "#/components/schemas/UUID"
        itemId:
          $ref: "#/components/schemas/UUID"
        itemName:
          type: string
        itemType:
          type: string
          enum: [low, medium, high]
        quantity:
          type: integer
        stock:
          type: integer
        createdAt:
          type: string
          format: date-time
      required:
        - groupId
        - userId
        - itemId
        - itemName
        - itemType
        - quantity
        - stock
        - createdAt

    CheckoutCartRequest:
      type: object
      properties:
        groupId:
          $ref: "#/components/schemas/UUID"
        dueDate:
          type: string
          format: date-time
          description: Due date for MEDIUM items (ignored for LOW/HIGH)
        beforeCondition:
          type: string
          enum: [unusable, damaged, decent, good, pristine]
          description: Item condition for MEDIUM items (ignored for LOW/HIGH)
        beforeConditionUrl:
          type: string
          format: uri
          description: Photo URL for MEDIUM items (ignored for LOW/HIGH)
      required:
        - groupId
        - dueDate
        - beforeCondition
        - beforeConditionUrl

    CheckoutCartResponse:
      type: object
      properties:
        lowItemsProcessed:
          type: array
          items:
            $ref: "#/components/schemas/CheckoutItemResult"
        mediumItemsBorrowed:
          type: array
          items:
            $ref: "#/components/schemas/CheckoutItemResult"
        highItemsRequested:
          type: array
          items:
            $ref: "#/components/schemas/CheckoutItemResult"
        errors:
          type: array
          items:
            $ref: "#/components/schemas/CheckoutError"
      required:
        - lowItemsProcessed
        - mediumItemsBorrowed
        - highItemsRequested
        - errors

    CheckoutItemResult:
      type: object
      properties:
        itemId:
          $ref: "#/components/schemas/UUID"
        itemName:
          type: string
        quantity:
          type: integer
        status:
          type: string
          enum: [completed, borrowed, pending_approval]
        borrowingId:
          $ref: "#/components/schemas/UUID"
        requestId:
          $ref: "#/components/schemas/UUID"
        takingId:
          $ref: "#/components/schemas/UUID"
      required:
        - itemId
        - itemName
        - quantity
        - status

    CheckoutError:
      type: object
      properties:
        itemId:
          $ref: "#/components/schemas/UUID"
        itemName:
          type: string
        message:
          type: string
      required:
        - itemId
        - message

    TakingHistoryResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        userId:
          $ref: "#/components/schemas/UUID"
        groupId:
          $ref: "#/components/schemas/UUID"
        itemId:
          $ref: "#/components/schemas/UUID"
        itemName:
          type: string
        quantity:
          type: integer
        takenAt:
          type: string
          format: date-time
      required:
        - id
        - userId
        - groupId
        - itemId
        - itemName
        - quantity
        - takenAt

    ItemTakingHistoryResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        userId:
          $ref: "#/components/schemas/UUID"
        userEmail:
          type: string
          format: email
        groupId:
          $ref: "#/components/schemas/UUID"
        itemId:
          $ref: "#/components/schemas/UUID"
        quantity:
          type: integer
        takenAt:
          type: string
          format: date-time
      required:
        - id
        - userId
        - userEmail
        - groupId
        - itemId
        - quantity
        - takenAt

    TakingStatsResponse:
      type: object
      properties:
        itemId:
          $ref: "#/components/schemas/UUID"
        totalTakings:
          type: integer
          description: Number of times item was taken
        totalQuantity:
          type: integer
          description: Total quantity taken
        uniqueUsers:
          type: integer
          description: Number of unique users
        firstTaking:
          type: string
          format: date-time
          nullable: true
        lastTaking:
          type: string
          format: date-time
          nullable: true
      required:
        - itemId
        - totalTakings
        - totalQuantity
        - uniqueUsers

    BorrowingRequest:
      type: object
      properties:
        user_id:
          type: string
          format: uuid
          description: The ID of the user borrowing the item
        group_id:
          type: string
          format: uuid
          description: The ID of the student group under which the item is borrowed
        item_id:
          type: string
          format: uuid
          description: The ID of the item being borrowed
        quantity:
          type: integer
          minimum: 1
          description: Quantity of the item to borrow
        due_date:
          type: string
          format: date-time
          description: When the item must be returned
        before_condition:
          type: string
          description: Note on the condition of the item before borrowing
        before_condition_url:
          type: string
          format: uri
          description: URL to a photo documenting the item's condition before borrowing
      required:
        - user_id
        - group_id
        - item_id
        - quantity
        - due_date
        - before_condition
        - before_condition_url

    BorrowingResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        user_id:
          $ref: "#/components/schemas/UUID"
        group_id:
          $ref: "#/components/schemas/UUID"
        item_id:
          $ref: "#/components/schemas/UUID"
        quantity:
          type: integer
        borrowed_at:
          type: string
          format: date-time
        due_date:
          type: string
          format: date-time
        returned_at:
          type: string
          format: date-time
          nullable: true
        before_condition:
          type: string
        before_condition_url:
          type: string
          format: uri
        after_condition:
          type: string
          nullable: true
        after_condition_url:
          type: string
          format: uri
          nullable: true
      required:
        - id
        - user_id
        - item_id
        - quantity
        - borrowed_at
        - due_date
        - before_condition
        - before_condition_url

    ReturnBorrowingRequest:
      type: object
      properties:
        after_condition:
          type: string
        after_condition_url:
          type: string
          format: uri
      required:
        - after_condition

    RequestStatus:
      type: string
      enum:
        - pending
        - approved
        - denied
        - fulfilled
        - pending_confirmation
        - confirmed
        - expired
        - no_show
        - cancelled
      description: Status of a request or booking

    RequestItemRequest:
      type: object
      properties:
        user_id:
          type: string
          format: uuid
          description: The ID of the user requesting the item
        group_id:
          type: string
          format: uuid
          description: The ID of the student group under which the item is requested
        item_id:
          type: string
          format: uuid
          description: The ID of the item being requested (must be high-value)
        quantity:
          type: integer
          minimum: 1
          description: Quantity of the item to request
      required:
        - user_id
        - group_id
        - item_id
        - quantity

    RequestItemResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        user_id:
          $ref: "#/components/schemas/UUID"
        group_id:
          $ref: "#/components/schemas/UUID"
        item_id:
          $ref: "#/components/schemas/UUID"
        quantity:
          type: integer
        status:
          $ref: "#/components/schemas/RequestStatus"
        reviewed_by:
          $ref: "#/components/schemas/UUID"
          nullable: true
        reviewed_at:
          type: string
          format: date-time
          nullable: true
      required:
        - id
        - user_id
        - group_id
        - item_id
        - quantity
        - status

    ReviewRequestRequest:
      type: object
      properties:
        status:
          $ref: "#/components/schemas/RequestStatus"
          description: New status (approved or denied)
        availability_id:
          $ref: "#/components/schemas/UUID"
          description: Required when approving HIGH items - specifies the time slot for pickup
        pickup_location:
          type: string
          description: Required when approving HIGH items - where to meet for pickup
        return_location:
          type: string
          description: Required when approving HIGH items - where to return the item
      required:
        - status

    Group:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
          example: "USSTM"
        description:
          type: string
          example: "TMU Science Society"
        logo_url:
          type: string
          description: Presigned URL to the group logo (1-hour expiry)
        logo_thumbnail_url:
          type: string
          description: Presigned URL to the 300x300 logo thumbnail
      required:
        - id
        - name

    ItemImage:
      type: object
      required: [id, item_id, url, thumbnail_url, display_order, is_primary, created_at]
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        item_id:
          $ref: "#/components/schemas/UUID"
        url:
          type: string
          description: Presigned URL to the full-size image (1-hour expiry)
        thumbnail_url:
          type: string
          description: Presigned URL to the 300x300 thumbnail (1-hour expiry)
        display_order:
          type: integer
        is_primary:
          type: boolean
        created_at:
          type: string
          format: date-time

    BorrowingImage:
      type: object
      required: [id, borrowing_id, url, image_type, created_at]
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        borrowing_id:
          $ref: "#/components/schemas/UUID"
        url:
          type: string
          description: Presigned URL to the image (1-hour expiry)
        image_type:
          type: string
          enum: [before, after]
        created_at:
          type: string
          format: date-time

    GroupCreateRequest:
      type: object
      properties:
        name:
          type: string
          example: "USSTM"
        description:
          type: string
          example: "TMU Science Society"
      required:
        - name

    GroupUpdateRequest:
      type: object
      properties:
        name:
          type: string
          example: "USSTM Updated"
        description:
          type: string
          example: "TMU Science Society Updated"
      required:
        - name

    TimeSlot:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        start_time:
          type: string
          format: time
          example: "09:00:00"
          description: Start time in HH:MM:SS format
        end_time:
          type: string
          format: time
          example: "09:15:00"
          description: End time in HH:MM:SS format
      required:
        - id
        - start_time
        - end_time

    CreateAvailabilityRequest:
      type: object
      properties:
        time_slot_id:
          $ref: "#/components/schemas/UUID"
        date:
          type: string
          format: date
          example: "2025-01-15"
          description: Date in YYYY-MM-DD format
      required:
        - time_slot_id
        - date

    AvailabilityResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        user_id:
          $ref: "#/components/schemas/UUID"
        time_slot_id:
          $ref: "#/components/schemas/UUID"
        date:
          type: string
          format: date
          example: "2025-01-15"
        user_email:
          type: string
          format: email
          example: "approver@example.com"
        start_time:
          type: string
          format: time
          example: "09:00:00"
        end_time:
          type: string
          format: time
          example: "09:15:00"
      required:
        - id
        - user_id
        - time_slot_id
        - date
        - user_email
        - start_time
        - end_time

    UserAvailabilityResponse:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        user_id:
          $ref: "#/components/schemas/UUID"
        time_slot_id:
          $ref: "#/components/schemas/UUID"
        date:
          type: string
          format: date
          example: "2025-01-15"
        start_time:
          type: string
          format: time
          example: "09:00:00"
        end_time:
          type: string
          format: time
          example: "09:15:00"
      required:
        - id
        - user_id
        - time_slot_id
        - date
        - start_time
        - end_time

    Booking:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        requester_id:
          $ref: "#/components/schemas/UUID"
        manager_id:
          $ref: "#/components/schemas/UUID"
        item_id:
          $ref: "#/components/schemas/UUID"
        availability_id:
          $ref: "#/components/schemas/UUID"
        pick_up_date:
          type: string
          format: date-time
        pick_up_location:
          type: string
        return_date:
          type: string
          format: date-time
        return_location:
          type: string
        status:
          $ref: "#/components/schemas/RequestStatus"
        confirmed_at:
          type: string
          format: date-time
          nullable: true
        confirmed_by:
          $ref: "#/components/schemas/UUID"
          nullable: true
        created_at:
          type: string
          format: date-time
      required:
        - id
        - requester_id
        - item_id
        - availability_id
        - pick_up_date
        - pick_up_location
        - return_date
        - return_location
        - status
        - created_at

    BookingResponse:
      allOf:
        - $ref: "#/components/schemas/Booking"
        - type: object
          properties:
            requester_email:
              type: string
            manager_email:
              type: string
            item_name:
              type: string
            item_type:
              $ref: "#/components/schemas/ItemType"
            availability_date:
              type: string
              format: date
            group_name:
              type: string
            start_time:
              type: string
              format: time
            end_time:
              type: string
              format: time

    ConfirmBookingRequest:
      type: object
      description: Empty request body for confirming a booking

    CancelBookingRequest:
      type: object
      properties:
        reason:
          type: string
          description: Optional cancellation reason

    HealthResponse:
      type: object
      properties:
        status:
          type: string
          example: "ok"
        timestamp:
          type: string
          format: date-time
          example: "2025-12-22T10:30:00Z"
      required:
        - status
        - timestamp

    ReadinessResponse:
      type: object
      properties:
        status:
          type: string
          enum: [ready, not_ready]
          example: "ready"
        timestamp:
          type: string
          format: date-time
        checks:
          type: object
          additionalProperties:
            type: string
          example:
            database: "ok"
      required:
        - status
        - timestamp
        - checks

    NotificationResponse:
      type: object
      properties:
        notification_id:
          $ref: "#/components/schemas/UUID"
        is_read:
          type: boolean
        notification_created_at:
          type: string
          format: date-time
        notification_object_id:
          $ref: "#/components/schemas/UUID"
        entity_id:
          $ref: "#/components/schemas/UUID"
        entity_type_name:
          type: string
        actor_id:
          $ref: "#/components/schemas/UUID"
        actor_email:
          type: string
          format: email
      required:
        - notification_id
        - is_read
        - notification_created_at
        - notification_object_id
        - entity_id
        - entity_type_name
        - actor_id
        - actor_email

    PaginatedNotificationResponse:
      type: object
      required: [data, meta]
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/NotificationResponse"
        meta:
          $ref: "#/components/schemas/PaginationMeta"

    UnreadNotificationCountResponse:
      type: object
      properties:
        unread_count:
          type: integer
      required:
        - unread_count

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    OAuth2:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: ""
          scopes:
            manage_items: "Create, update, and delete items globally"
            manage_groups: "Create, update, and delete groups"
            manage_users: "Create, update, and delete users globally"
            manage_group_users: "Add/remove users from specific group"
            approve_all_requests: "Approve/deny requests across all groups"
            view_group_data: "View requests/borrowings within specific group"
            view_all_data: "View requests/borrowings across all groups"
            manage_time_slots: "Create and manage available time slots"
            manage_all_bookings: "Manage booking schedules globally"
            manage_group_bookings: "Manage booking schedules for specific group"
            view_items: "View item catalog"
            manage_cart: "Add/remove items from cart"
            request_items: "Submit requests for borrowing items"
            view_own_data: "View own requests and borrowings"
security:
  - BearerAuth: []
paths:
  /health:
    get:
      tags:
        - Health
      security: []
      summary: Health Check
      description: Returns server health status (liveness probe)
      operationId: healthCheck
      responses:
        "200":
          description: Server is alive
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"

  /ready:
    get:
      tags:
        - Health
      security: []
      summary: Readiness Check
      description: Returns server readiness status (checks database connectivity)
      operationId: readinessCheck
      responses:
        "200":
          description: Server is ready
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReadinessResponse"
        "503":
          description: Server is not ready
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReadinessResponse"

  /auth/request-otp:
    post:
      tags:
        - Authentication
      security: []
      summary: Request OTP
      description: Sends a one-time password to the user's email address
      operationId: requestOTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RequestOTPRequest"
      responses:
        "200":
          description: OTP sent successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageResponse"
        "429":
          description: Too many requests (cooldown active)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "400":
          description: Invalid body
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/verify-otp:
    post:
      tags:
        - Authentication
      security: []
      summary: Verify OTP
      description: Verifies the OTP and returns access and refresh tokens
      operationId: verifyOTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyOTPRequest"
      responses:
        "200":
          description: OTP verified, tokens returned
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"
        "400":
          description: Invalid or expired OTP
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/refresh:
    post:
      tags:
        - Authentication
      security: []
      summary: Refresh Tokens
      description: Exchanges a valid refresh token for a new access/refresh token pair
      operationId: refreshToken
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshRequest"
      responses:
        "200":
          description: New token pair
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Invalid or expired refresh token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/logout:
    post:
      tags:
        - Authentication
      security: []
      summary: Logout
      description: Revokes the refresh token
      operationId: logout
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LogoutRequest"
      responses:
        "200":
          description: Logged out successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageResponse"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /time-slots:
    get:
      tags:
        - Time Slots
      summary: List all pre-defined time slots
      description: Retrieve all available time slots (15-minute intervals from 08:00 to 18:00)
      operationId: listTimeSlots
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of time slots
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TimeSlot"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /availability:
    post:
      tags:
        - Availability
      summary: Create availability
      description: Approvers set their availability schedule (not group-specific)
      operationId: createAvailability
      security:
        - BearerAuth: []
        - OAuth2: [manage_time_slots]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateAvailabilityRequest"
      responses:
        "201":
          description: Availability created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AvailabilityResponse"
        "400":
          description: Bad request (invalid date, date in past)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict (already have availability for this slot/date)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      tags:
        - Availability
      summary: List availability
      description: List all availability with optional filters
      operationId: listAvailability
      security:
        - BearerAuth: []
      parameters:
        - name: date
          in: query
          description: Filter by specific date (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date
        - name: user_id
          in: query
          description: Filter by user ID
          required: false
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: List of availability
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AvailabilityResponse"
        "400":
          description: Bad request (invalid date format)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /availability/{date}:
    get:
      tags:
        - Availability
      summary: Get availability by date
      description: Get all approvers available on a specific date
      operationId: getAvailabilityByDate
      security:
        - BearerAuth: []
      parameters:
        - name: date
          in: path
          description: Date to check (YYYY-MM-DD)
          required: true
          schema:
            type: string
            format: date
      responses:
        "200":
          description: Availability for the specified date
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AvailabilityResponse"
        "400":
          description: Bad request (invalid date format)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /availability/{id}:
    get:
      tags:
        - Availability
      summary: Get availability by ID
      description: Get a single availability record
      operationId: getAvailabilityByID
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: Availability ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Availability details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AvailabilityResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Availability not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    delete:
      tags:
        - Availability
      summary: Delete availability
      description: Remove an availability record (approvers only, cannot delete if referenced by active bookings)
      operationId: deleteAvailability
      security:
        - BearerAuth: []
        - OAuth2: [manage_time_slots]
      parameters:
        - name: id
          in: path
          description: Availability ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Availability deleted successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Availability not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Conflict (availability is referenced by active bookings)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /users/{userId}/availability:
    get:
      tags:
        - Availability
      summary: Get user availability
      description: Get a user's availability schedule (all authenticated users can view any approver's availability for booking)
      operationId: getUserAvailability
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: User ID
          required: true
          schema:
            type: string
            format: uuid
        - name: from_date
          in: query
          description: Start date filter (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date
        - name: to_date
          in: query
          description: End date filter (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date
      responses:
        "200":
          description: User's availability schedule
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UserAvailabilityResponse"
        "400":
          description: Bad request (invalid date format)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bookings/{bookingId}:
    get:
      tags:
        - Bookings
      summary: Get booking by ID
      description: Get a specific booking (owners can view own, admins view all)
      operationId: getBookingByID
      security:
        - BearerAuth: []
      parameters:
        - name: bookingId
          in: path
          description: Booking ID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Booking details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BookingResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Booking not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bookings:
    get:
      tags:
        - Bookings
      summary: List bookings
      description: List bookings with role-based filtering
      operationId: listBookings
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by booking status
          required: false
          schema:
            $ref: "#/components/schemas/RequestStatus"
        - name: group_id
          in: query
          description: Filter by group ID
          required: false
          schema:
            type: string
            format: uuid
        - name: from_date
          in: query
          description: Start date filter (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date
        - name: to_date
          in: query
          description: End date filter (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of bookings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBookingResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bookings/my-bookings:
    get:
      tags:
        - Bookings
      summary: Get my bookings
      description: Get authenticated user's bookings
      operationId: getMyBookings
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by booking status
          required: false
          schema:
            $ref: "#/components/schemas/RequestStatus"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: User's bookings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBookingResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bookings/{bookingId}/confirm:
    patch:
      tags:
        - Bookings
      summary: Confirm booking
      description: User confirms pickup time (must be requester, within 48h, before pickup)
      operationId: confirmBooking
      security:
        - BearerAuth: []
      parameters:
        - name: bookingId
          in: path
          description: Booking ID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConfirmBookingRequest"
      responses:
        "200":
          description: Booking confirmed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BookingResponse"
        "400":
          description: Bad request (already confirmed, expired, past pickup date)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions (not the requester)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Booking not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bookings/{bookingId}/cancel:
    patch:
      tags:
        - Bookings
      summary: Cancel booking
      description: Cancel booking (requester before pickup, managers/admins anytime)
      operationId: cancelBooking
      security:
        - BearerAuth: []
      parameters:
        - name: bookingId
          in: path
          description: Booking ID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CancelBookingRequest"
      responses:
        "200":
          description: Booking cancelled
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BookingResponse"
        "400":
          description: Bad request (already cancelled)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Booking not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /bookings/pending-confirmation:
    get:
      tags:
        - Bookings
      summary: List pending confirmation
      description: List bookings awaiting user confirmation (managers/admins only)
      operationId: listPendingConfirmation
      security:
        - BearerAuth: []
      parameters:
        - name: group_id
          in: query
          description: Filter by group ID
          required: false
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Bookings pending confirmation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/BookingResponse"
        "400":
          description: Bad request - group_id required for group administrators
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /groups:
    get:
      summary: Get all groups
      operationId: getAllGroups
      tags: ["Groups"]
      security:
        - BearerAuth: []
      responses:
        "200":
          description: List of all groups
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Group"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: No groups found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      summary: Create a new group
      operationId: createGroup
      tags: ["Groups"]
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupCreateRequest"
      responses:
        "201":
          description: Group successfully created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Group"
        "400":
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /groups/{id}:
    get:
      summary: Get group by ID
      operationId: getGroupByID
      tags: ["Groups"]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: Group found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Group"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      summary: Update group
      operationId: updateGroup
      tags: ["Groups"]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupUpdateRequest"
      responses:
        "200":
          description: Updated group data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Group"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete group
      operationId: deleteGroup
      tags: ["Groups"]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "204":
          description: Group successfully deleted
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Group not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /ping:
    get:
      tags:
        - Protected
      summary: Protected ping endpoint
      description: Simple protected endpoint to test authentication
      operationId: pingProtected
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      responses:
        "200":
          description: Successful ping
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PingResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /items:
    get:
      tags:
        - Items
      summary: Get all items with search and filtering
      description: Retrieve all items from the catalog with optional search and filtering capabilities
      operationId: getItems
      security:
        - BearerAuth: []
        - OAuth2: [view_items]
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
        - name: q
          in: query
          description: Search query for name and description
          schema:
            type: string
        - name: type
          in: query
          description: Filter by item type
          schema:
            $ref: "#/components/schemas/ItemType"
        - name: in_stock
          in: query
          description: Filter by availability (stock > 0)
          schema:
            type: boolean
      responses:
        "200":
          description: List of items
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedItemResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to view items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

    post:
      tags:
        - Items
      summary: Create an item
      description: Add a new item to the catalog
      operationId: createItem
      security:
        - BearerAuth: []
        - OAuth2: [manage_items]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ItemPostRequest"
            examples:
              withUrls:
                summary: Example item
                value:
                  name: "Laptop"
                  description: "Dell XPS 13"
                  type: "high"
                  stock: 5
                  urls:
                    - "http://example.com/laptop1.jpg"
                    - "http://example.com/laptop2.jpg"
              withoutUrls:
                summary: Example item without URLs
                value:
                  name: "Laptop"
                  description: "Dell XPS 13"
                  type: "high"
                  stock: 5

      responses:
        "201":
          description: Item created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ItemPostRequest"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to create items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /items/type/{type}:
    get:
      tags:
        - Items
      summary: Get items by type
      description: Retrieve items filtered by type
      operationId: getItemsByType
      security:
        - BearerAuth: []
        - OAuth2: [view_items]
      parameters:
        - name: type
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/ItemType"
          example:
            type: "high"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of items by type
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedItemResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to view items of this type."
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "No items found for this type."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /items/{id}:
    get:
      tags:
        - Items
      summary: Get item by ID
      description: Retrieve a single item by its ID
      operationId: getItemById
      security:
        - BearerAuth: []
        - OAuth2: [view_items]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
          example:
            id: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        "200":
          description: Item details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ItemResponse"
              example:
                id: "123e4567-e89b-12d3-a456-426614174000"
                name: "Laptop"
                description: "Dell XPS 13"
                type: "high"
                stock: 5
                urls:
                  - "http://example.com/laptop1.jpg"
                  - "http://example.com/laptop2.jpg"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to view this item."
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "Item not found."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

    patch:
      tags:
        - Items
      summary: Partially update item
      description: Update any subset of item fields
      operationId: patchItem
      security:
        - BearerAuth: []
        - OAuth2: [manage_items]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ItemResponse"
            examples:
              patchDescription:
                summary: Patch item description
                value:
                  description: "Updated description for the item"
              patchStock:
                summary: Patch item stock
                value:
                  stock: 10
      responses:
        "200":
          description: Item updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ItemResponse"
              example:
                id: "123e4567-e89b-12d3-a456-426614174000"
                name: "Laptop"
                description: "Dell XPS 13 Updated"
                type: "high"
                stock: 10
                urls:
                  - "http://example.com/laptop1.jpg"
                  - "http://example.com/laptop2.jpg"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to update this item."
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "Item not found."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

    put:
      tags:
        - Items
      summary: Update item
      description: Update an existing item
      operationId: updateItem
      security:
        - BearerAuth: []
        - OAuth2: [manage_items]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ItemPostRequest"
            examples:
              updateItemWithoutUrls:
                summary: Update item without URLs
                value:
                  name: "Laptop"
                  description: "Dell XPS 13 Updated"
                  type: "high"
                  stock: 10
              updateItemWithUrls:
                summary: Update item with URLs
                value:
                  name: "Laptop"
                  description: "Dell XPS 13 Updated with URLs"
                  type: "high"
                  stock: 10
                  urls:
                    - "http://example.com/laptop1.jpg"
                    - "http://example.com/laptop2.jpg"

      responses:
        "200":
          description: Item updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ItemPostRequest"
              example:
                id: "123e4567-e89b-12d3-a456-426614174000"
                name: "Laptop"
                description: "Dell XPS 13 Updated"
                type: "high"
                stock: 10
                urls:
                  - "http://example.com/laptop1.jpg"
                  - "http://example.com/laptop2.jpg"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to update this item."
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "Item not found."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

    delete:
      tags:
        - Items
      summary: Delete item
      description: Delete an item by its ID
      operationId: deleteItem
      security:
        - BearerAuth: []
        - OAuth2: [manage_items]
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
          example:
            id: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        "204":
          description: Item deleted
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to delete this item."
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "Item not found."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /admin/users:
    get:
      tags:
        - Admin
      summary: Get all users (admin only)
      description: Retrieve all users - requires admin permissions
      operationId: getUsers
      security:
        - BearerAuth: []
        - OAuth2: [manage_users]
      responses:
        "200":
          description: List of users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
              example:
                - id: "123e4567-e89b-12d3-a456-426614174000"
                  email: "admin@test.com"
                  role: "admin"
                - id: "456e7890-e89b-12d3-a456-426614174001"
                  email: "member@test.com"
                  role: "member"
                - id: "789e1234-e89b-12d3-a456-426614174002"
                  email: "groupadmin@test.com"
                  role: "group_admin"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Unauthorized"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "Insufficient permissions"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /admin/users/group/{groupId}:
    get:
      tags:
        - Admin
      summary: Get users by group
      description: Retrieve all users in a specific group - requires group admin permissions
      operationId: getUsersByGroup
      security:
        - BearerAuth: []
        - OAuth2: [manage_group_users]
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
          description: The ID of the group
          example: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        "200":
          description: List of users in the group
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/GroupUser"
              example:
                - id: "456e7890-e89b-12d3-a456-426614174001"
                  email: "member@test.com"
                  role_name: "member"
                  scope: "group"
                  scope_id: "123e4567-e89b-12d3-a456-426614174000"
                - id: "789e1234-e89b-12d3-a456-426614174002"
                  email: "groupadmin@test.com"
                  role_name: "group_admin"
                  scope: "group"
                  scope_id: "123e4567-e89b-12d3-a456-426614174000"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Unauthorized"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "Insufficient permissions"
        "404":
          description: Group not found or no users in group
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                groupNotFound:
                  summary: Group does not exist
                  value:
                    code: 404
                    message: "Group not found"
                noUsersInGroup:
                  summary: Group exists but has no users
                  value:
                    code: 404
                    message: "No users found in the specified group"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /users/{userId}:
    get:
      tags:
        - Users
      summary: Get user by ID
      description: Retrieve a specific user by their ID
      operationId: getUserById
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
          description: The ID of the user
          example: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              example:
                id: "123e4567-e89b-12d3-a456-426614174000"
                email: "admin@test.com"
                role: "admin"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Unauthorized"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "Insufficient permissions"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "User not found"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "Internal server error"

  /users/email/{email}:
    get:
      tags:
        - Users
      summary: Get user by email
      description: Retrieve a specific user by their email address
      operationId: getUserByEmail
      security:
        - BearerAuth: []
        - OAuth2: [manage_users]
      parameters:
        - name: email
          in: path
          required: true
          schema:
            type: string
            format: email
          description: The email address of the user
          example: "admin@test.com"
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              example:
                id: "123e4567-e89b-12d3-a456-426614174000"
                email: "admin@test.com"
                role: "admin"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Unauthorized"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "Insufficient permissions"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "User not found"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "Internal server error"

  /admin/invite:
    post:
      tags:
        - Admin
      summary: Invite user (admin only)
      description: Invite a new user to the system - requires global or group admin permissions
      operationId: inviteUser
      security:
        - BearerAuth: []
        - OAuth2: [manage_group_users]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InviteUserRequest"
            examples:
              addGlobalAdmin:
                summary: Invite global admin
                value:
                  email: "global@global.ca"
                  role_name: "global_admin"
                  scope: "global"
              addGroupAdmin:
                summary: Invite group admin
                value:
                  email: "vp.operations@usstm.ca"
                  role_name: "group_admin"
                  scope: "group"
                  scope_id: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        "201":
          description: Invitation code created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InviteUserResponse"
              example:
                code: "JTEIMashVdutQ88SIXpKNeZgVYCX7H73"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to invite users."
        "404":
          description: Not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 404
                message: "Scope not found."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /cart/{groupId}:
    get:
      tags:
        - Cart
      summary: Get user's cart
      description: Retrieve all items in the user's cart for a specific group
      operationId: GetCart
      security:
        - BearerAuth: []
        - OAuth2: [manage_cart]
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: Cart items retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CartItemResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    delete:
      tags:
        - Cart
      summary: Clear cart
      description: Remove all items from the user's cart
      operationId: ClearCart
      security:
        - BearerAuth: []
        - OAuth2: [manage_cart]
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "204":
          description: Cart cleared successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /cart/{groupId}/items:
    post:
      tags:
        - Cart
      summary: Add item to cart
      description: Add an item to the user's cart or update quantity if already exists
      operationId: AddToCart
      security:
        - BearerAuth: []
        - OAuth2: [manage_cart]
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddToCartRequest"
      responses:
        "200":
          description: Item added to cart successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CartItemResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Item not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /cart/{groupId}/items/{itemId}:
    patch:
      tags:
        - Cart
      summary: Update cart item quantity
      description: Update the quantity of an item in the cart
      operationId: UpdateCartItemQuantity
      security:
        - BearerAuth: []
        - OAuth2: [manage_cart]
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                quantity:
                  type: integer
                  minimum: 1
              required:
                - quantity
      responses:
        "200":
          description: Quantity updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CartItemResponse"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Item not in cart
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    delete:
      tags:
        - Cart
      summary: Remove item from cart
      description: Remove a specific item from the cart
      operationId: RemoveFromCart
      security:
        - BearerAuth: []
        - OAuth2: [manage_cart]
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "204":
          description: Item removed from cart successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /checkout:
    post:
      tags:
        - Checkout
      summary: Checkout cart
      description: |
        Process all items in cart with type-specific logic:
        - LOW items: Decrement stock only (no borrowing record, audit trail created)
        - MEDIUM items: Create borrowing record + decrement stock
        - HIGH items: Create approval request (stock decremented after approval)
      operationId: CheckoutCart
      security:
        - BearerAuth: []
        - OAuth2: [request_items]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CheckoutCartRequest"
      responses:
        "200":
          description: Checkout processed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CheckoutCartResponse"
        "400":
          description: Bad Request (e.g., cart is empty)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /audit/takings/users/{userId}:
    get:
      tags:
        - Audit
      summary: Get user taking history
      description: |
        View LOW items taken by a user with role-based access control:
        - Regular users: Can only view their own taking history
        - Group admins: Can view taking history for users in their group(s)
        - Global admins: Can view any user's taking history
      operationId: GetUserTakingHistory
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
          description: The ID of the user whose taking history to retrieve
        - name: groupId
          in: query
          schema:
            $ref: "#/components/schemas/UUID"
          description: Optional group ID to filter results (for group admins)
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: Taking history retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedTakingHistoryResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions to view this user's data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /audit/takings/items/{itemId}:
    get:
      tags:
        - Audit
      summary: Get taking history for an item
      description: View all users who took this LOW item (admin only)
      operationId: GetItemTakingHistory
      security:
        - BearerAuth: []
        - OAuth2: [view_all_data]
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: Item taking history retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedItemTakingHistoryResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /audit/takings/items/{itemId}/stats:
    get:
      tags:
        - Audit
      summary: Get taking statistics for an item
      description: Get aggregate stats for LOW item usage (admin only)
      operationId: GetItemTakingStats
      security:
        - BearerAuth: []
        - OAuth2: [view_all_data]
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date-time
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date-time
      responses:
        "200":
          description: Taking statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TakingStatsResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /borrowings/item:
    post:
      tags:
        - Borrowings
      summary: Borrow an item (creating a borrowing record)
      description: Submit a new borrowing item request
      operationId: BorrowItem
      security:
        - BearerAuth: []
        - OAuth2: [request_items]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BorrowingRequest"
      responses:
        "201":
          description: Borrowed Item created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/item/return/{itemId}:
    post:
      tags:
        - Borrowings
      summary: Return a borrowed item
      description: Marks a borrowing as returned and records its condition
      operationId: returnItem
      security:
        - BearerAuth: []
        - OAuth2: [request_items]
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReturnBorrowingRequest"
      responses:
        "200":
          description: Item returned
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/item/status/{itemId}:
    get:
      tags:
        - Borrowings
      summary: Get the status of a certain borrowed item
      description: Retrieves the status of a specific borrowed item
      operationId: CheckBorrowingItemStatus
      security:
        - BearerAuth: []
        - OAuth2: [request_items]
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: Status of the borrowed item
          content:
            application/json:
              schema:
                type: object
                properties:
                  is_borrowed:
                    type: boolean
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/item/active:
    get:
      tags:
        - Borrowings
      summary: Get all active borrowings
      description: Retrieves all currently active borrowing records
      operationId: GetAllActiveBorrowedItems
      security:
        - BearerAuth: []
        - OAuth2: [view_all_data]
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of active borrowings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/item/returned:
    get:
      tags:
        - Borrowings
      summary: Get all returned borrowings
      description: Retrieves all returned borrowing records
      operationId: GetAllReturnedItems
      security:
        - BearerAuth: []
        - OAuth2: [view_all_data]
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of returned borrowings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/item/returned/{due_date}:
    get:
      tags:
        - Borrowings
      summary: Get all returned borrowings by due date
      description: Retrieves all returned borrowing records filtered by due date
      operationId: GetActiveBorrowedItemsToBeReturnedByDate
      security:
        - BearerAuth: []
        - OAuth2: [view_all_data]
      parameters:
        - name: due_date
          in: path
          required: true
          schema:
            type: string
            format: date
      responses:
        "200":
          description: List of returned borrowings by due date
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/BorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/user/{userId}:
    get:
      tags:
        - Borrowings
      summary: Get borrowings for a user
      description: Retrieves all borrowing records for a user
      operationId: GetBorrowedItemHistoryByUserId
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of borrowings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/user/active/{userId}:
    get:
      tags:
        - Borrowings
      summary: Get currently active borrowings for a user
      description: Retrieves all currently active borrowing records for a user
      operationId: GetActiveBorrowedItemsByUserId
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of current active borrowings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."

  /borrowings/user/returned/{userId}:
    get:
      tags:
        - Borrowings
      summary: Get returned borrowings for a user
      description: Retrieves all returned borrowing records for a user
      operationId: GetReturnedItemsByUserId
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of returned borrowings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedBorrowingResponse"
        "400":
          description: Bad Request - invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 400
                message: "Invalid input data."
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 401
                message: "Credentials Invalid or Not Provided"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 403
                message: "You do not have permission to request items."
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                code: 500
                message: "An unexpected error occurred."
  /requests/item:
    post:
      tags:
        - Requests
      summary: Request a high-value item
      description: Create a request for approval to borrow a high-value item
      operationId: RequestItem
      security:
        - BearerAuth: []
        - OAuth2: [request_items]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RequestItemRequest"
      responses:
        "201":
          description: Request created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RequestItemResponse"
        "400":
          description: Bad Request - invalid input or not a high-value item
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Item not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /requests/{requestId}/review:
    post:
      tags:
        - Requests
      summary: Review (approve/deny) a request
      description: Approve or deny a pending request for a high-value item
      operationId: ReviewRequest
      security:
        - BearerAuth: []
        - OAuth2: [approve_all_requests]
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReviewRequestRequest"
      responses:
        "200":
          description: Request reviewed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RequestItemResponse"
        "400":
          description: Bad Request - request not found, already reviewed, or insufficient stock
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /requests:
    get:
      tags:
        - Requests
      summary: Get all requests
      description: Retrieves all requests system-wide
      operationId: GetAllRequests
      security:
        - BearerAuth: []
        - OAuth2: [view_all_data]
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of all requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedRequestResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /requests/pending:
    get:
      tags:
        - Requests
      summary: Get pending requests
      description: Retrieves all pending requests awaiting approval
      operationId: GetPendingRequests
      security:
        - BearerAuth: []
        - OAuth2: [approve_all_requests]
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of pending requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedRequestResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /requests/user/{userId}:
    get:
      tags:
        - Requests
      summary: Get requests by user
      description: Retrieves all requests for a specific user
      operationId: GetRequestsByUserId
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: List of user requests
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RequestItemResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /requests/{requestId}:
    get:
      tags:
        - Requests
      summary: Get request by ID
      description: Retrieves a specific request by its ID
      operationId: GetRequestById
      security:
        - BearerAuth: []
        - OAuth2: [view_own_data]
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: Request details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RequestItemResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Request not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /items/{itemId}/images:
    post:
      operationId: UploadItemImage
      summary: Upload an image for an item
      security:
        - BearerAuth: []
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [image]
              properties:
                image:
                  type: string
                  format: binary
                display_order:
                  type: integer
                is_primary:
                  type: boolean
      responses:
        "201":
          description: Image uploaded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ItemImage"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      operationId: ListItemImages
      summary: List all images for an item
      security:
        - BearerAuth: []
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: List of item images
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ItemImage"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /items/{itemId}/images/{imageId}:
    delete:
      operationId: DeleteItemImage
      summary: Delete an item image
      security:
        - BearerAuth: []
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: imageId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "204":
          description: Image deleted
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /items/{itemId}/images/{imageId}/primary:
    put:
      operationId: SetItemPrimaryImage
      summary: Set an image as the primary image for an item
      security:
        - BearerAuth: []
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: imageId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: Primary image updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ItemImage"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /borrowings/{borrowingId}/images:
    post:
      operationId: UploadBorrowingImage
      summary: Upload a before/after condition photo for a borrowing
      security:
        - BearerAuth: []
      parameters:
        - name: borrowingId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [image, image_type]
              properties:
                image:
                  type: string
                  format: binary
                image_type:
                  type: string
                  enum: [before, after]
      responses:
        "201":
          description: Image uploaded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BorrowingImage"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      operationId: ListBorrowingImages
      summary: List condition photos for a borrowing
      security:
        - BearerAuth: []
      parameters:
        - name: borrowingId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: List of condition photos
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/BorrowingImage"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /borrowings/{borrowingId}/images/{imageId}:
    delete:
      operationId: DeleteBorrowingImage
      summary: Delete a borrowing condition photo
      security:
        - BearerAuth: []
      parameters:
        - name: borrowingId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
        - name: imageId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "204":
          description: Image deleted
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /groups/{groupId}/logo:
    put:
      operationId: UploadGroupLogo
      summary: Upload or replace the logo for a group (must be square)
      security:
        - BearerAuth: []
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [image]
              properties:
                image:
                  type: string
                  format: binary
      responses:
        "200":
          description: Logo updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Group"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /notifications:
    get:
      tags:
        - Notifications
      summary: Get user notifications
      operationId: GetNotifications
      security:
        - BearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        "200":
          description: A paginated list of notifications
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedNotificationResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /notifications/unread-count:
    get:
      tags:
        - Notifications
      summary: Get user unread notification count
      operationId: GetUnreadNotificationCount
      security:
        - BearerAuth: []
      responses:
        "200":
          description: The unread notification count
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnreadNotificationCountResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /notifications/{id}/read:
    put:
      tags:
        - Notifications
      summary: Mark a specific notification as read
      operationId: MarkNotificationAsRead
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: The marked notification
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Notification not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /notifications/read-all:
    put:
      tags:
        - Notifications
      summary: Mark all user notifications as read
      operationId: MarkAllNotificationsAsRead
      security:
        - BearerAuth: []
      responses:
        "200":
          description: All notifications marked as read
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
